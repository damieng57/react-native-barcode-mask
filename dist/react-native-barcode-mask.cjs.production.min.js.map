{"version":3,"file":"react-native-barcode-mask.cjs.production.min.js","sources":["../src/BarcodeMask.tsx","../src/hocs/withOuterLayout.tsx","../src/hooks/useBarcodeFinder.ts","../src/hooks/useInternalBarcodeRead.ts","../src/index.ts","../src/hooks/useBarcodeReadAndroid.ts","../src/hooks/useBarcodeReadIOS.ts","../src/hooks/useCustomBarcodeReadAndroid.ts","../src/hooks/useCustomBarcodeReadIOS.ts"],"sourcesContent":["import React, { FC, memo } from 'react';\nimport { LayoutChangeEvent, StyleSheet, View, ViewStyle } from 'react-native';\nimport Animated, { Easing } from 'react-native-reanimated';\nimport { WithOuterLayoutProps } from './interfaces';\n\nconst { Value, Clock, block, cond, set, startClock, timing, eq } = Animated;\n\ntype DimensionUnit = string | number;\ntype EdgePosition = 'topLeft' | 'topRight' | 'bottomLeft' | 'bottomRight';\n\n/**\n *\n */\nexport type RunTimingFn = (\n  clock: Animated.Clock,\n  value: number,\n  destination: number,\n  duration: number\n) => Animated.Node<number>;\n\nexport type OnLayoutChangeHandler = (event: LayoutChangeEvent) => void;\n\n/**\n * @name BarcodeMaskProps\n * @description Props of BarcodeMask component\n */\nexport interface BarcodeMaskProps extends WithOuterLayoutProps {\n  /**\n   * @name width\n   * @type DimensionUnit\n   * @description Width of the Barcode Finder Area\n   * @default 280\n   */\n  width?: DimensionUnit;\n  /**\n   * @name height\n   * @type DimensionUnit\n   * @description Height of the Barcode Finder Area\n   * @default 230\n   */\n  height?: DimensionUnit;\n  /**\n   * @name edgeWidth\n   * @type number\n   * @description Width of corner edges\n   * @default 20\n   */\n  edgeWidth?: number;\n  /**\n   * @name edgeHeight\n   * @type number\n   * @description Height of corner edges\n   * @default 20\n   */\n  edgeHeight?: DimensionUnit;\n  /**\n   * @name edgeColor\n   * @type string\n   * @description Color of corner edges\n   * @default #fff\n   */\n  edgeColor?: string;\n  /**\n   * @name edgeRadius\n   * @type number\n   * @description Border Radius of corner edges\n   * @default 0\n   */\n  edgeRadius?: number;\n  /**\n   * @name edgeBorderWidth\n   * @type DimensionUnit\n   * @description Thickness of corner edges\n   * @default 4\n   */\n  edgeBorderWidth?: DimensionUnit;\n  /**\n   * @name backgroundColor\n   * @type string\n   * @description Background color of Outer Finder Area\n   * @default #eee\n   */\n  backgroundColor?: string;\n  /**\n   * @name maskOpacity\n   * @type number\n   * @description Opacity of Outer Finder Area\n   * @default 1\n   */\n  maskOpacity?: number;\n  /**\n   * @name showAnimatedLine\n   * @type boolean\n   * @description Whether to show Animated Line\n   * @default true\n   */\n  showAnimatedLine?: boolean;\n  /**\n   * @name startValue\n   * @type number\n   * @description Start value of Animated Line (only applicable if `showAnimatedLine` is set to `true`)\n   * @default 0\n   */\n  startValue?: number;\n  /**\n   * @name destinationValue\n   * @type number\n   * @description Destination value of Animated Line (depends on`animatedLineOrientation`)\n   * @default Computed by the length of the respective orientation minus the `animatedLineThickness`\n   */\n  destinationValue?: number;\n  /**\n   * @name animatedComponent\n   * @type Function\n   * @param width\n   * @param height\n   */\n  animatedComponent?: (width: number, height: number) => React.ReactElement;\n  /**\n   * @name animatedLineThickness\n   * @type number\n   * @description Thickness of Animated Line\n   * @default 2\n   */\n  animatedLineThickness?: number;\n  /**\n   * @name animatedLineOrientation\n   * @type 'vertical' | 'horizontal'\n   * @description Orientation that the Animated Line will be drawn\n   * @default 'horizontal'\n   */\n  animatedLineOrientation?: 'vertical' | 'horizontal';\n  /**\n   * @name animatedLineColor\n   * @type string\n   * @description Color of Animated Line\n   * @default #fff\n   */\n  animatedLineColor?: string;\n  /**\n   * @name animationDuration\n   * @type number\n   * @description Duration of Animated Line animation (in ms)\n   * @default 2000\n   */\n  animationDuration?: number;\n  /**\n   * @name runTimingFn\n   * @type RunTimingFn\n   * @description Function to trigger the animation\n   * @default internal `runTiming` function\n   */\n  runTimingFn?: RunTimingFn;\n  /**\n   * @name onLayoutChange\n   * @type OnLayoutChangeHandler\n   * @description Handler to handle LayoutChange. Useful if you want to only detect barcode inside the Finder Area.\n   *   This will be provided from a custom hook that this library also provides.\n   * @default noop\n   */\n  onLayoutChange?: OnLayoutChangeHandler;\n}\n\nconst runTiming: RunTimingFn = (\n  clock: Animated.Clock,\n  value: number,\n  destination: number,\n  duration: number\n) => {\n  const timingState: Animated.TimingState = {\n    finished: new Value(0),\n    position: new Value(value),\n    time: new Value(0),\n    frameTime: new Value(0),\n  };\n\n  const timingConfig: Animated.TimingConfig = {\n    duration,\n    toValue: new Value(destination),\n    easing: Easing.inOut(Easing.ease) as any,\n  };\n\n  return block([\n    startClock(clock),\n    timing(clock, timingState, timingConfig),\n    cond(timingState.finished, [\n      set(timingState.finished, 0),\n      set(timingState.time, 0),\n      set(timingState.frameTime, 0),\n      set(\n        timingState.position,\n        cond(eq(timingState.position, destination), destination, value)\n      ),\n      set(\n        timingConfig.toValue as Animated.Value<number>,\n        cond(eq(timingState.position, destination), value, destination)\n      ),\n    ]),\n    timingState.position,\n  ]);\n};\n\nconst noop = () => {};\n\nexport const BarcodeMask: FC<BarcodeMaskProps> = memo(\n  ({\n    width,\n    height,\n    startValue,\n    destinationValue,\n    backgroundColor,\n    edgeBorderWidth,\n    edgeColor,\n    edgeHeight,\n    edgeWidth,\n    edgeRadius,\n    maskOpacity,\n    animatedComponent,\n    animatedLineColor,\n    animatedLineOrientation,\n    animatedLineThickness,\n    animationDuration,\n    showAnimatedLine,\n    runTimingFn,\n    onLayoutChange,\n    outerBoundingRect,\n    onOuterLayout,\n  }) => {\n    const edgeBorderStyle = React.useRef<\n      {\n        [position in EdgePosition]: ViewStyle;\n      }\n    >({\n      topRight: {\n        borderRightWidth: edgeBorderWidth as number,\n        borderTopWidth: edgeBorderWidth as number,\n        borderTopRightRadius: edgeRadius,\n        top: -(edgeBorderWidth as number),\n        right: -(edgeBorderWidth as number),\n      },\n      topLeft: {\n        borderTopWidth: edgeBorderWidth as number,\n        borderLeftWidth: edgeBorderWidth as number,\n        borderTopLeftRadius: edgeRadius,\n        top: -(edgeBorderWidth as number),\n        left: -(edgeBorderWidth as number),\n      },\n      bottomRight: {\n        borderBottomWidth: edgeBorderWidth as number,\n        borderRightWidth: edgeBorderWidth as number,\n        borderBottomRightRadius: edgeRadius,\n        bottom: -(edgeBorderWidth as number),\n        right: -(edgeBorderWidth as number),\n      },\n      bottomLeft: {\n        borderBottomWidth: edgeBorderWidth as number,\n        borderLeftWidth: edgeBorderWidth as number,\n        borderBottomLeftRadius: edgeRadius,\n        bottom: -(edgeBorderWidth as number),\n        left: -(edgeBorderWidth as number),\n      },\n    });\n\n    const _animatedLineDimension = (\n      dimension: DimensionUnit | undefined,\n      outerDimension: 'width' | 'height'\n    ) => {\n      const outer = outerBoundingRect?.[outerDimension] ?? 0;\n      if (dimension) {\n        if (typeof dimension === 'number') {\n          return dimension * 0.9;\n        }\n        return dimension.endsWith('%')\n          ? (Number(dimension.split('%')[0]) / 100) * (outer || 1) * 0.9\n          : Number(dimension.split(/\\d+/)[0]) * (outer || 1) * 0.9;\n      }\n      return outer * 0.9;\n    };\n\n    const _animatedValue = (\n      dimension: DimensionUnit | undefined,\n      outerDimension: 'width' | 'height'\n    ) => {\n      const calculatedDimension = _animatedLineDimension(\n        dimension,\n        outerDimension\n      );\n      const fullDimension = calculatedDimension / 0.9;\n\n      return fullDimension - (animatedLineThickness as number);\n    };\n\n    const _animatedLineStyle = () => {\n      if (animatedLineOrientation === 'horizontal') {\n        const _width = _animatedLineDimension(width, 'width');\n        const destination = _animatedValue(height, 'height');\n        return {\n          ...styles.animatedLine,\n          height: animatedLineThickness,\n          width: _width,\n          backgroundColor: animatedLineColor,\n          top: runTimingFn!(\n            new Clock(),\n            startValue || 0,\n            destinationValue || destination,\n            animationDuration as number\n          ),\n        };\n      }\n      const _height = _animatedLineDimension(height, 'height');\n      const destination = _animatedValue(width, 'width');\n      return {\n        ...styles.animatedLine,\n        width: animatedLineThickness,\n        height: _height,\n        backgroundColor: animatedLineColor,\n        left: runTimingFn!(\n          new Clock(),\n          startValue || 0,\n          destinationValue || destination,\n          animationDuration as number\n        ),\n      };\n    };\n\n    const _renderEdge = (edgePosition: EdgePosition) => {\n      const defaultStyle = {\n        width: edgeWidth,\n        height: edgeHeight,\n        borderColor: edgeColor,\n        zIndex: 2,\n      };\n      return (\n        <View\n          style={{\n            ...defaultStyle,\n            ...styles[edgePosition],\n            ...edgeBorderStyle.current[edgePosition],\n          }}\n        />\n      );\n    };\n\n    const _width = _animatedLineDimension(width, 'width') / 0.9;\n    const _height = _animatedLineDimension(height, 'height') / 0.9;\n\n    const _renderAnimated = () => {\n      if (showAnimatedLine) {\n        if (animatedComponent) {\n          return animatedComponent(_width, _height);\n        }\n\n        return <Animated.View style={_animatedLineStyle()} />;\n      }\n\n      return null;\n    };\n\n    return (\n      <View style={styles.container}>\n        <View\n          onLayout={onLayoutChange || noop}\n          style={{\n            ...styles.finder,\n            width: _width,\n            height: _height,\n          }}\n        >\n          {_renderEdge('topLeft')}\n          {_renderEdge('topRight')}\n          {_renderEdge('bottomLeft')}\n          {_renderEdge('bottomRight')}\n          {_renderAnimated()}\n        </View>\n        <View style={styles.maskOuter} onLayout={onOuterLayout || noop}>\n          <View\n            style={{\n              ...styles.maskRow,\n              ...{ backgroundColor, opacity: maskOpacity, flex: 1 },\n            }}\n          />\n          <View style={{ height, ...styles.maskCenter }}>\n            <View style={{ backgroundColor, opacity: maskOpacity, flex: 1 }} />\n            <View\n              style={{\n                ...styles.maskInner,\n                width,\n                height,\n                borderRadius: edgeRadius,\n              }}\n            />\n            <View style={{ backgroundColor, opacity: maskOpacity, flex: 1 }} />\n          </View>\n          <View\n            style={{\n              ...styles.maskRow,\n              ...{ backgroundColor, opacity: maskOpacity, flex: 1 },\n            }}\n          />\n        </View>\n      </View>\n    );\n  }\n);\n\nBarcodeMask.defaultProps = {\n  width: 280,\n  height: 230,\n  edgeWidth: 20,\n  edgeHeight: 20,\n  edgeColor: '#fff',\n  edgeBorderWidth: 4,\n  edgeRadius: 0,\n  backgroundColor: '#eee',\n  maskOpacity: 1,\n  animatedLineColor: '#fff',\n  animatedLineOrientation: 'horizontal',\n  animatedLineThickness: 2,\n  animationDuration: 2000,\n  runTimingFn: runTiming,\n  showAnimatedLine: true,\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    alignItems: 'center',\n    justifyContent: 'center',\n    ...StyleSheet.absoluteFillObject,\n  },\n  finder: {\n    alignItems: 'center',\n    justifyContent: 'center',\n    zIndex: 1,\n  },\n  maskOuter: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    width: '100%',\n    height: '100%',\n    alignItems: 'center',\n    justifyContent: 'space-around',\n  },\n  maskInner: {\n    backgroundColor: 'transparent',\n  },\n  maskRow: {\n    width: '100%',\n  },\n  maskCenter: {\n    flexDirection: 'row',\n    display: 'flex',\n  },\n  topLeft: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n  },\n  topRight: {\n    position: 'absolute',\n    top: 0,\n    right: 0,\n  },\n  bottomLeft: {\n    position: 'absolute',\n    bottom: 0,\n    left: 0,\n  },\n  bottomRight: {\n    position: 'absolute',\n    bottom: 0,\n    right: 0,\n  },\n  animatedLine: {\n    position: 'absolute',\n    zIndex: 1,\n  },\n});\n","import React, { ComponentType, PureComponent } from 'react';\nimport { LayoutChangeEvent } from 'react-native';\nimport { BoundingRect, Optionalize, WithOuterLayoutProps } from '../interfaces';\n\nexport interface WithOuterLayoutHocState {\n  boundingRect: BoundingRect;\n}\n\nexport const withOuterLayout = <\n  T extends WithOuterLayoutProps = WithOuterLayoutProps\n>(\n  WrappedComponent: ComponentType<T>\n) => {\n  const displayName =\n    WrappedComponent.displayName || WrappedComponent.name || 'Component';\n\n  return class ComponentWithOuterLayout extends PureComponent<\n    Optionalize<T, WithOuterLayoutProps>,\n    WithOuterLayoutHocState\n  > {\n    public static displayName = `withOuterLayout${displayName}`;\n\n    state: WithOuterLayoutHocState = {\n      boundingRect: { x: 0, y: 0, width: 0, height: 0 },\n    };\n\n    onOuterLayout = (event: LayoutChangeEvent): void => {\n      const {\n        nativeEvent: { layout },\n      } = event;\n      this.setState({ boundingRect: layout });\n    };\n\n    render() {\n      return (\n        <WrappedComponent\n          outerBoundingRect={this.state.boundingRect}\n          onOuterLayout={this.onOuterLayout}\n          {...(this.props as T)}\n        />\n      );\n    }\n  };\n};\n","import { Reducer, useCallback, useReducer, useState } from 'react';\nimport { LayoutChangeEvent } from 'react-native';\nimport { BoundingRect, CustomBarcodeRead } from '../interfaces';\n\n/**\n * @internal\n * @param dataProcessor\n * @param onScannedData\n * @param customBarcodeRead\n */\nexport default (\n  dataProcessor: (data: string) => string,\n  onScannedData: (processed: string) => void,\n  customBarcodeRead?: CustomBarcodeRead | number\n) => {\n  const [barcodeRead, setBarcodeRead] = useState(false);\n  const [state, dispatch] = useReducer<\n    Reducer<\n      BoundingRect,\n      {\n        type: 'SET';\n        payload: BoundingRect;\n      }\n    >\n  >(\n    (prev, action) => {\n      switch (action.type) {\n        case 'SET': {\n          return { ...prev, ...action.payload };\n        }\n        default: {\n          return prev;\n        }\n      }\n    },\n    {\n      width: 0,\n      height: 0,\n      x: 0,\n      y: 0,\n    }\n  );\n  const _onBarcodeFinderLayoutChange = useCallback(\n    (event: LayoutChangeEvent) => {\n      const {\n        nativeEvent: {\n          layout: { height, width, x, y },\n        },\n      } = event;\n      dispatch({ type: 'SET', payload: { height, width, x, y } });\n    },\n    [state.height, state.width, state.x, state.y]\n  );\n\n  let timeoutId;\n  let processingReadBarcode: (data: string) => void;\n\n  if (\n    !customBarcodeRead ||\n    (customBarcodeRead && typeof customBarcodeRead === 'number')\n  ) {\n    timeoutId && clearTimeout(timeoutId);\n    processingReadBarcode = data => {\n      setBarcodeRead(true);\n      onScannedData(dataProcessor(data));\n      timeoutId = setTimeout(() => {\n        setBarcodeRead(false);\n      }, customBarcodeRead);\n    };\n  } else {\n    processingReadBarcode = data => {\n      (customBarcodeRead as CustomBarcodeRead)?.beforeScan?.();\n      onScannedData(dataProcessor(data));\n      (customBarcodeRead as CustomBarcodeRead)?.afterScan?.();\n    };\n  }\n\n  return {\n    barcodeRead:\n      customBarcodeRead && typeof customBarcodeRead === 'object'\n        ? null\n        : barcodeRead,\n    finderX: state.x,\n    finderY: state.y,\n    finderWidth: state.width,\n    finderHeight: state.height,\n    onBarcodeFinderLayoutChange: _onBarcodeFinderLayoutChange,\n    processingReadBarcode,\n  };\n};\n","import { useCallback } from 'react';\nimport { PixelRatio, Platform } from 'react-native';\nimport { BarCodeType, Point, RNCamera, Size } from 'fleetback-react-native-camera';\n\nconst useInternalBarcodeReadIOS = (\n  barcodeRead: boolean,\n  isFocused: boolean,\n  finderX: number,\n  finderY: number,\n  finderWidth: number,\n  finderHeight: number,\n  processingReadBarcode: (data: string) => void\n) =>\n  useCallback(\n    (event: {\n      data: string;\n      bounds:\n        | { width: number; height: number; origin: Array<Point<string>> }\n        | { origin: Point<string>; size: Size<string> };\n      type: keyof BarCodeType;\n    }) => {\n      if (!isFocused || barcodeRead) {\n        return;\n      }\n\n      const {\n        origin: { x, y },\n        size: { width, height },\n      } = event.bounds as { origin: Point<string>; size: Size<string> };\n\n      if (\n        Number(x) >= finderX &&\n        Number(x) + Number(width) <= finderX + finderWidth &&\n        Number(y) >= finderY &&\n        Number(y) + Number(height) <= finderY + finderHeight\n      ) {\n        return processingReadBarcode(event.data);\n      }\n    },\n    [\n      barcodeRead,\n      isFocused,\n      finderX,\n      finderY,\n      finderWidth,\n      finderHeight,\n      processingReadBarcode,\n    ]\n  );\n\nconst useInternalBarcodeReadAndroid = (\n  barcodeRead: boolean,\n  isFocused: boolean,\n  finderX: number,\n  finderY: number,\n  finderWidth: number,\n  finderHeight: number,\n  processingReadBarcode: (data: string) => void\n) =>\n  useCallback(\n    (event: {\n      data: string;\n      bounds:\n        | { width: number; height: number; origin: Array<Point<string>> }\n        | { origin: Point<string>; size: Size<string> };\n      type: keyof BarCodeType;\n    }) => {\n      if (!isFocused || barcodeRead) {\n        return;\n      }\n\n      const _bounds = event.bounds as {\n        width: number;\n        height: number;\n        origin: Point<string>[];\n      };\n      const _pointBounds = _bounds.origin.map(point => ({\n        x: Number(point.x) / PixelRatio.get(),\n        y: Number(point.y) / PixelRatio.get(),\n      }));\n\n      const _insideBox = (point: { x: number; y: number }) => {\n        const { x, y } = point;\n        return (\n          x >= finderX &&\n          x <= finderX + finderWidth &&\n          y >= finderY &&\n          y <= finderY + finderHeight\n        );\n      };\n\n      /**\n       *  0 --------------- 2\n       *  |  PDF417         |\n       *  | /////////////// |\n       *  1 --------------- 3\n       */\n      if (event.type === RNCamera.Constants.BarCodeType.pdf417) {\n        const [topLeft, bottomLeft, topRight, bottomRight] = _pointBounds;\n        if (\n          _insideBox(topLeft) &&\n          _insideBox(bottomLeft) &&\n          _insideBox(topRight) &&\n          _insideBox(bottomRight)\n        ) {\n          processingReadBarcode(event.data);\n          return;\n        }\n      }\n\n      /**\n       *  2 ------ 3\n       *  |\n       *  | QR Code\n       *  |\n       *  1 ------ 0\n       */\n      if (event.type === RNCamera.Constants.BarCodeType.qr) {\n        const [bottomRight, bottomLeft, topLeft, topRight] = _pointBounds;\n        if (\n          _insideBox(bottomRight) &&\n          _insideBox(bottomLeft) &&\n          _insideBox(topLeft) &&\n          _insideBox(topRight)\n        ) {\n          processingReadBarcode(event.data);\n          return;\n        }\n      }\n    },\n    [\n      barcodeRead,\n      isFocused,\n      finderX,\n      finderY,\n      finderWidth,\n      finderHeight,\n      processingReadBarcode,\n    ]\n  );\n\nexport default Platform.select({\n  android: useInternalBarcodeReadAndroid,\n  ios: useInternalBarcodeReadIOS,\n}) as typeof useInternalBarcodeReadAndroid;\n","import { Platform } from 'react-native';\nimport { BarcodeMask } from './BarcodeMask';\nimport { withOuterLayout } from './hocs';\nimport {\n  useBarcodeReadAndroid,\n  useBarcodeReadIOS,\n  useCustomBarcodeReadAndroid,\n  useCustomBarcodeReadIOS,\n} from './hooks';\nimport {\n  BoundingRect,\n  CustomBarcodeRead,\n  CustomBarcodeReadCallback,\n  WithOuterLayoutProps,\n} from './interfaces';\n\nconst useBarcodeRead = Platform.select({\n  android: useBarcodeReadAndroid,\n  ios: useBarcodeReadIOS,\n}) as typeof useBarcodeReadIOS;\n\nconst useCustomBarcodeRead = Platform.select({\n  android: useCustomBarcodeReadAndroid,\n  ios: useCustomBarcodeReadIOS,\n}) as typeof useCustomBarcodeReadIOS;\n\nconst BarcodeMaskWithOuterLayout = withOuterLayout(BarcodeMask);\n\nexport {\n  BarcodeMask,\n  BarcodeMaskWithOuterLayout,\n  useBarcodeRead,\n  useCustomBarcodeRead,\n  CustomBarcodeRead,\n  CustomBarcodeReadCallback,\n  BoundingRect,\n  WithOuterLayoutProps,\n  withOuterLayout,\n};\n","import useBarcodeFinder from './useBarcodeFinder';\nimport useInternalBarcodeRead from './useInternalBarcodeRead';\n\nexport default (\n  isFocused: boolean,\n  dataProcessor: (data: string) => string,\n  onScannedData: (processed: string) => void,\n  barcodeReadDelay: number = 500\n) => {\n  const {\n    barcodeRead,\n    onBarcodeFinderLayoutChange,\n    finderY,\n    finderX,\n    finderWidth,\n    finderHeight,\n    processingReadBarcode,\n  } = useBarcodeFinder(dataProcessor, onScannedData, barcodeReadDelay);\n\n  const onBarcodeRead = useInternalBarcodeRead(\n    barcodeRead != null ? barcodeRead : false,\n    isFocused,\n    finderX,\n    finderY,\n    finderWidth,\n    finderHeight,\n    processingReadBarcode\n  );\n\n  return {\n    barcodeRead,\n    onBarcodeRead,\n    onBarcodeFinderLayoutChange,\n  };\n};\n","import useBarcodeFinder from './useBarcodeFinder';\nimport useInternalBarcodeRead from './useInternalBarcodeRead';\n\nexport default (\n  isFocused: boolean,\n  dataProcessor: (data: string) => string,\n  onScannedData: (processed: string) => void,\n  barcodeReadDelay: number = 500\n) => {\n  const {\n    barcodeRead,\n    onBarcodeFinderLayoutChange,\n    finderY,\n    finderX,\n    finderWidth,\n    finderHeight,\n    processingReadBarcode,\n  } = useBarcodeFinder(dataProcessor, onScannedData, barcodeReadDelay);\n\n  const onBarcodeRead = useInternalBarcodeRead(\n    barcodeRead != null ? barcodeRead : false,\n    isFocused,\n    finderX,\n    finderY,\n    finderWidth,\n    finderHeight,\n    processingReadBarcode\n  );\n\n  return {\n    barcodeRead,\n    onBarcodeRead,\n    onBarcodeFinderLayoutChange,\n  };\n};\n","import { CustomBarcodeRead, CustomBarcodeReadCallback } from '../interfaces';\nimport useBarcodeFinder from './useBarcodeFinder';\nimport useInternalBarcodeRead from './useInternalBarcodeRead';\n\nexport default (\n  isFocused: boolean,\n  dataProcessor: (data: string) => string,\n  onScannedData: (processed: string) => void,\n  customBarcodeRead: CustomBarcodeRead,\n  customBarcodeReadCallback: CustomBarcodeReadCallback\n) => {\n  const {\n    barcodeRead,\n    onBarcodeFinderLayoutChange,\n    finderY,\n    finderX,\n    finderWidth,\n    finderHeight,\n    processingReadBarcode,\n  } = useBarcodeFinder(dataProcessor, onScannedData, customBarcodeRead);\n\n  return {\n    barcodeRead,\n    onBarcodeRead: customBarcodeReadCallback\n      ? customBarcodeReadCallback(\n          {\n            x: finderX,\n            y: finderY,\n            width: finderWidth,\n            height: finderHeight,\n          },\n          processingReadBarcode\n        )\n      : useInternalBarcodeRead(\n          barcodeRead != null ? barcodeRead : false,\n          isFocused,\n          finderX,\n          finderY,\n          finderWidth,\n          finderHeight,\n          processingReadBarcode\n        ),\n    onBarcodeFinderLayoutChange,\n  };\n};\n","import { CustomBarcodeRead, CustomBarcodeReadCallback } from 'interfaces';\nimport useBarcodeFinder from './useBarcodeFinder';\nimport useInternalBarcodeRead from './useInternalBarcodeRead';\n\nexport default (\n  isFocused: boolean,\n  dataProcessor: (data: string) => string,\n  onScannedData: (processed: string) => void,\n  customBarcodeRead: CustomBarcodeRead,\n  customBarcodeReadCallback: CustomBarcodeReadCallback\n) => {\n  const {\n    barcodeRead,\n    onBarcodeFinderLayoutChange,\n    finderHeight,\n    finderWidth,\n    finderX,\n    finderY,\n    processingReadBarcode,\n  } = useBarcodeFinder(dataProcessor, onScannedData, customBarcodeRead);\n\n  return {\n    barcodeRead,\n    onBarcodeRead: customBarcodeReadCallback\n      ? customBarcodeReadCallback(\n          {\n            x: finderX,\n            y: finderY,\n            width: finderWidth,\n            height: finderHeight,\n          },\n          processingReadBarcode\n        )\n      : useInternalBarcodeRead(\n          barcodeRead != null ? barcodeRead : false,\n          isFocused,\n          finderX,\n          finderY,\n          finderWidth,\n          finderHeight,\n          processingReadBarcode\n        ),\n    onBarcodeFinderLayoutChange,\n  };\n};\n"],"names":["Value","Animated","Clock","block","cond","set","startClock","timing","eq","noop","BarcodeMask","memo","_ref","width","height","startValue","destinationValue","backgroundColor","edgeBorderWidth","edgeColor","edgeHeight","edgeWidth","edgeRadius","maskOpacity","animatedComponent","animatedLineColor","animatedLineOrientation","animatedLineThickness","animationDuration","showAnimatedLine","runTimingFn","onLayoutChange","outerBoundingRect","onOuterLayout","edgeBorderStyle","React","useRef","topRight","borderRightWidth","borderTopWidth","borderTopRightRadius","top","right","topLeft","borderLeftWidth","borderTopLeftRadius","left","bottomRight","borderBottomWidth","borderBottomRightRadius","bottom","bottomLeft","borderBottomLeftRadius","_animatedLineDimension","dimension","outerDimension","outer","_outerBoundingRect$ou","endsWith","Number","split","_animatedValue","_renderEdge","edgePosition","View","style","_extends","borderColor","zIndex","styles","current","_width","_height","container","onLayout","finder","destination","animatedLine","_animatedLineStyle","maskOuter","maskRow","opacity","flex","maskCenter","maskInner","borderRadius","defaultProps","clock","value","duration","timingState","finished","position","time","frameTime","timingConfig","toValue","easing","Easing","inOut","ease","StyleSheet","create","alignItems","justifyContent","absoluteFillObject","flexDirection","display","withOuterLayout","WrappedComponent","displayName","name","ComponentWithOuterLayout","boundingRect","x","y","_this","event","setState","nativeEvent","layout","prototype","render","this","state","props","PureComponent","dataProcessor","onScannedData","customBarcodeRead","timeoutId","processingReadBarcode","_useState","useState","barcodeRead","setBarcodeRead","_useReducer","useReducer","prev","action","type","payload","dispatch","_onBarcodeFinderLayoutChange","useCallback","_event$nativeEvent$la","clearTimeout","data","setTimeout","beforeScan","afterScan","finderX","finderY","finderWidth","finderHeight","onBarcodeFinderLayoutChange","Platform","select","android","isFocused","_pointBounds","bounds","origin","map","point","PixelRatio","get","_insideBox","RNCamera","Constants","BarCodeType","pdf417","qr","ios","_event$bounds","_event$bounds$origin","_event$bounds$size","size","useBarcodeRead","barcodeReadDelay","_useBarcodeFinder","useBarcodeFinder","onBarcodeRead","useInternalBarcodeRead","useCustomBarcodeRead","customBarcodeReadCallback","BarcodeMaskWithOuterLayout"],"mappings":"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"}